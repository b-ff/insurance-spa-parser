!function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=0)}([function(t,e){var r=this&&this.__spreadArrays||function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<r;e++)for(var i=arguments[e],u=0,s=i.length;u<s;u++,o++)n[o]=i[u];return n},n=/^filter-panel-\d{4,}_header-title-textEl$/,o=/^messageTypeCombo-\d{4,}-inputEl$/,i=/^commonInsurersCombo-\d{4,}-picker-listEl$/,u=/^commonInsurersCombo-\d{4,}-trigger-picker$/,s=/^filter-panel-\d{4,}$/,l=/^parcelsList-\d{4,}-body$/,a=function(t,e,r){void 0===r&&(r="div");var n=t.querySelectorAll(r);return Array.from(n).find((function(t){return e.test(t.id)}))};window.getElementByIdPattern=a;var c=function(){function t(){var t=this,e=setInterval((function(){var r=a(document,n);if(r){t.addStartButton(r);var o=a(document,u);o.click(),setTimeout((function(){o.click()}),500),clearInterval(e)}}),500);this.log("Parser initialized!")}return t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];console&&console.log&&console.log.apply(console,r(["Parser: "],t))},t.prototype.addStartButton=function(t){var e=this,r=document.createElement("button");r.innerHTML="Запустить сбор данных",r.id="parser-start-button",r.style.marginLeft="10px",r.style.cursor="pointer",r.onclick=function(){e.startParser()},t.append(r),this.log("Added start button to container:",t)},t.prototype.startParser=function(){this.log("Parser started!"),this.setMessageType(this.getMessageTypes()[0]),this.setInsurer(this.getInsurers()[0]),this.getFilterSubmitButton().click(),this.downloadFile(this.getFilesList().pop())},t.prototype.getMessageTypes=function(){return["Отчёт МО в МГФОМС","Отчёт МО в СМО"]},t.prototype.setMessageType=function(t){a(document,o,"input").value=t,this.log("Set message type filter to:",t)},t.prototype.getInsurersSuggestions=function(){return Array.from(a(document,i,"ul").childNodes)},t.prototype.getInsurers=function(){return this.getInsurersSuggestions().map((function(t){return t.textContent}))},t.prototype.setInsurer=function(t){this.getInsurersSuggestions().find((function(e){return e.textContent===t})).click(),this.log("Set insurer filter to:",t)},t.prototype.getFilterSubmitButton=function(){var t=a(document,s).querySelectorAll("a.x-btn");return t.length?t[0]:null},t.prototype.getDateFromElement=function(t){if(t){if(t.textContent)return e=t.textContent,r="dd.mm.yyyy hh:ii",n=e.replace(/[^a-zA-Z0-9]/g,"-"),o=r.toLowerCase().replace(/[^a-zA-Z0-9]/g,"-").split("-"),i=n.split("-"),u=o.indexOf("mm"),s=o.indexOf("dd"),l=o.indexOf("yyyy"),a=o.indexOf("hh"),c=o.indexOf("ii"),d=o.indexOf("ss"),f=new Date,p=l>-1?+i[l]:f.getFullYear(),g=u>-1?+i[u]:f.getMonth(),y=s>-1?+i[s]:f.getDate(),m=a>-1?+i[a]:f.getHours(),h=c>-1?+i[c]:f.getMinutes(),v=d>-1?+i[d]:f.getSeconds(),new Date(p,g,y,m,h,v);this.log("Empty Date Cell Text!",t)}else this.log("Date node not found!",t);var e,r,n,o,i,u,s,l,a,c,d,f,p,g,y,m,h,v;return null},t.prototype.getFilesList=function(){var t=this;return Array.from(a(document,l).querySelectorAll("table")).map((function(e){var r=e.querySelectorAll("td"),n=r[5],o=r[9];return{url:n?n.querySelector("a").href:null,sendDate:o?t.getDateFromElement(o.firstChild):new Date}})).sort((function(t,e){return t.sendDate.getTime()-e.sendDate.getTime()}))},t.prototype.downloadFile=function(t){this.log("file download >>",t),t.url&&window.open(t.url,"_blank")},t}();window.parser=new c}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL3BhcnNlci50cyJdLCJuYW1lcyI6WyJpbnN0YWxsZWRNb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiZXhwb3J0cyIsIm1vZHVsZSIsImkiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwidCIsIm1vZGUiLCJfX2VzTW9kdWxlIiwibnMiLCJjcmVhdGUiLCJrZXkiLCJiaW5kIiwibiIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsIlNUQVJUX0JVVFRPTl9DT05UQUlORVJfSURfUEFUVEVSTiIsIk1FU1NBR0VfVFlQRV9GSUVMRF9JRF9QQVRURVJOIiwiSU5TVVJFUlNfTElTVF9JRF9QQVRURVJOIiwiSU5TVVJFUlNfTElTVF9UT0dHTEVfSURfUEFUVEVSTiIsIkZJTFRFUlNfUEFORUxfSURfUEFUVEVSTiIsIlBBUkNFTFNfTElTVF9JRF9QQVRURVJOIiwiZ2V0RWxlbWVudEJ5SWRQYXR0ZXJuIiwicGFyZW50IiwiaWRQYXR0ZXJuIiwidGFnTmFtZSIsImVsZW1lbnRzIiwicXVlcnlTZWxlY3RvckFsbCIsIkFycmF5IiwiZnJvbSIsImZpbmQiLCJlbGVtZW50IiwidGVzdCIsImlkIiwid2luZG93IiwiaW50ZXJ2YWxJZCIsInNldEludGVydmFsIiwiYnV0dG9uQ29udGFpbmVyIiwiZG9jdW1lbnQiLCJhZGRTdGFydEJ1dHRvbiIsImNsaWNrIiwic2V0VGltZW91dCIsImNsZWFySW50ZXJ2YWwiLCJ0aGlzIiwibG9nIiwiY29uc29sZSIsImFyZ3MiLCJjb250YWluZXIiLCJidXR0b24iLCJjcmVhdGVFbGVtZW50IiwiaW5uZXJIVE1MIiwic3R5bGUiLCJtYXJnaW5MZWZ0IiwiY3Vyc29yIiwib25jbGljayIsInN0YXJ0UGFyc2VyIiwiYXBwZW5kIiwic2V0TWVzc2FnZVR5cGUiLCJnZXRNZXNzYWdlVHlwZXMiLCJzZXRJbnN1cmVyIiwiZ2V0SW5zdXJlcnMiLCJnZXRGaWx0ZXJTdWJtaXRCdXR0b24iLCJkb3dubG9hZEZpbGUiLCJnZXRGaWxlc0xpc3QiLCJwb3AiLCJtZXNzYWdlVHlwZSIsImdldEluc3VyZXJzU3VnZ2VzdGlvbnMiLCJjaGlsZE5vZGVzIiwibWFwIiwidGV4dENvbnRlbnQiLCJpbnN1cmVyIiwiYnV0dG9ucyIsImxlbmd0aCIsImdldERhdGVGcm9tRWxlbWVudCIsIm5vZGUiLCJ0ZXh0IiwiZm9ybWF0Iiwibm9ybWFsaXplZCIsInJlcGxhY2UiLCJmb3JtYXRJdGVtcyIsInRvTG93ZXJDYXNlIiwic3BsaXQiLCJkYXRlSXRlbXMiLCJtb250aEluZGV4IiwiaW5kZXhPZiIsImRheUluZGV4IiwieWVhckluZGV4IiwiaG91ckluZGV4IiwibWludXRlc0luZGV4Iiwic2Vjb25kc0luZGV4IiwidG9kYXkiLCJEYXRlIiwieWVhciIsImdldEZ1bGxZZWFyIiwibW9udGgiLCJnZXRNb250aCIsImRheSIsImdldERhdGUiLCJob3VyIiwiZ2V0SG91cnMiLCJtaW51dGUiLCJnZXRNaW51dGVzIiwic2Vjb25kIiwiZ2V0U2Vjb25kcyIsInRhYmxlRWxlbWVudCIsImNlbGxzIiwidXJsQ2VsbCIsImRhdGVDZWxsIiwidXJsIiwicXVlcnlTZWxlY3RvciIsImhyZWYiLCJzZW5kRGF0ZSIsImZpcnN0Q2hpbGQiLCJzb3J0IiwiYSIsImIiLCJnZXRUaW1lIiwiZmlsZSIsIm9wZW4iLCJwYXJzZXIiLCJQYXJzZXIiXSwibWFwcGluZ3MiOiJhQUNFLElBQUlBLEVBQW1CLEdBR3ZCLFNBQVNDLEVBQW9CQyxHQUc1QixHQUFHRixFQUFpQkUsR0FDbkIsT0FBT0YsRUFBaUJFLEdBQVVDLFFBR25DLElBQUlDLEVBQVNKLEVBQWlCRSxHQUFZLENBQ3pDRyxFQUFHSCxFQUNISSxHQUFHLEVBQ0hILFFBQVMsSUFVVixPQU5BSSxFQUFRTCxHQUFVTSxLQUFLSixFQUFPRCxRQUFTQyxFQUFRQSxFQUFPRCxRQUFTRixHQUcvREcsRUFBT0UsR0FBSSxFQUdKRixFQUFPRCxRQUtmRixFQUFvQlEsRUFBSUYsRUFHeEJOLEVBQW9CUyxFQUFJVixFQUd4QkMsRUFBb0JVLEVBQUksU0FBU1IsRUFBU1MsRUFBTUMsR0FDM0NaLEVBQW9CYSxFQUFFWCxFQUFTUyxJQUNsQ0csT0FBT0MsZUFBZWIsRUFBU1MsRUFBTSxDQUFFSyxZQUFZLEVBQU1DLElBQUtMLEtBS2hFWixFQUFvQmtCLEVBQUksU0FBU2hCLEdBQ1gsb0JBQVhpQixRQUEwQkEsT0FBT0MsYUFDMUNOLE9BQU9DLGVBQWViLEVBQVNpQixPQUFPQyxZQUFhLENBQUVDLE1BQU8sV0FFN0RQLE9BQU9DLGVBQWViLEVBQVMsYUFBYyxDQUFFbUIsT0FBTyxLQVF2RHJCLEVBQW9Cc0IsRUFBSSxTQUFTRCxFQUFPRSxHQUV2QyxHQURVLEVBQVBBLElBQVVGLEVBQVFyQixFQUFvQnFCLElBQy9CLEVBQVBFLEVBQVUsT0FBT0YsRUFDcEIsR0FBVyxFQUFQRSxHQUE4QixpQkFBVkYsR0FBc0JBLEdBQVNBLEVBQU1HLFdBQVksT0FBT0gsRUFDaEYsSUFBSUksRUFBS1gsT0FBT1ksT0FBTyxNQUd2QixHQUZBMUIsRUFBb0JrQixFQUFFTyxHQUN0QlgsT0FBT0MsZUFBZVUsRUFBSSxVQUFXLENBQUVULFlBQVksRUFBTUssTUFBT0EsSUFDdEQsRUFBUEUsR0FBNEIsaUJBQVRGLEVBQW1CLElBQUksSUFBSU0sS0FBT04sRUFBT3JCLEVBQW9CVSxFQUFFZSxFQUFJRSxFQUFLLFNBQVNBLEdBQU8sT0FBT04sRUFBTU0sSUFBUUMsS0FBSyxLQUFNRCxJQUM5SSxPQUFPRixHQUlSekIsRUFBb0I2QixFQUFJLFNBQVMxQixHQUNoQyxJQUFJUyxFQUFTVCxHQUFVQSxFQUFPcUIsV0FDN0IsV0FBd0IsT0FBT3JCLEVBQWdCLFNBQy9DLFdBQThCLE9BQU9BLEdBRXRDLE9BREFILEVBQW9CVSxFQUFFRSxFQUFRLElBQUtBLEdBQzVCQSxHQUlSWixFQUFvQmEsRUFBSSxTQUFTaUIsRUFBUUMsR0FBWSxPQUFPakIsT0FBT2tCLFVBQVVDLGVBQWUxQixLQUFLdUIsRUFBUUMsSUFHekcvQixFQUFvQmtDLEVBQUksR0FJakJsQyxFQUFvQkEsRUFBb0JtQyxFQUFJLEcsdU9DM0UvQ0MsRUFBb0MsNENBQ3BDQyxFQUFnQyxvQ0FFaENDLEVBQTJCLDZDQUMzQkMsRUFBa0MsOENBQ2xDQyxFQUEyQix3QkFDM0JDLEVBQTBCLDRCQVkxQkMsRUFBd0IsU0FBQ0MsRUFBZ0NDLEVBQW1CQyxRQUFBLElBQUFBLE1BQUEsT0FDaEYsSUFBTUMsRUFBV0gsRUFBT0ksaUJBQWlCRixHQUN6QyxPQUFPRyxNQUFNQyxLQUFLSCxHQUFVSSxNQUFLLFNBQUNDLEdBQThCLE9BQUFQLEVBQVVRLEtBQUtELEVBQVFFLFFBR3hGQyxPQUFlWixzQkFBd0JBLEVBRXhDLElBMEJBLGFBQ0Usd0JBQ1FhLEVBQWFDLGFBQVksV0FDN0IsSUFBTUMsRUFBa0JmLEVBQXNCZ0IsU0FBVXRCLEdBRXhELEdBQUlxQixFQUFpQixDQUNuQixFQUFLRSxlQUFlRixHQUVwQixJQUFNLEVBQXFCZixFQUFzQmdCLFNBQVVuQixHQUMzRCxFQUFtQnFCLFFBQ25CQyxZQUFXLFdBQWMsRUFBbUJELFVBQVcsS0FFdkRFLGNBQWNQLE1BRWYsS0FHSFEsS0FBS0MsSUFBSSx1QkFnSGIsT0E3R1UsWUFBQUEsSUFBUixXLElBQVksc0RBQ05DLFNBQVdBLFFBQVFELEtBQ3JCQyxRQUFRRCxJQUFHLE1BQVhDLFFBQU8sR0FBSyxZQUFlQyxLQUl2QixZQUFBUCxlQUFSLFNBQXVCUSxHQUF2QixXQUNRQyxFQUFTVixTQUFTVyxjQUFjLFVBRXRDRCxFQUFPRSxVQUFZLHdCQUNuQkYsRUFBT2YsR0FyRmEsc0JBc0ZwQmUsRUFBT0csTUFBTUMsV0FBYSxPQUMxQkosRUFBT0csTUFBTUUsT0FBUyxVQUN0QkwsRUFBT00sUUFBVSxXQUFjLEVBQUtDLGVBRXBDUixFQUFVUyxPQUFPUixHQUVqQkwsS0FBS0MsSUFBSSxtQ0FBb0NHLElBR3hDLFlBQUFRLFlBQVAsV0FDRVosS0FBS0MsSUFBSSxtQkFFVEQsS0FBS2MsZUFBZWQsS0FBS2Usa0JBQWtCLElBQzNDZixLQUFLZ0IsV0FBV2hCLEtBQUtpQixjQUFjLElBQ25DakIsS0FBS2tCLHdCQUF3QnJCLFFBRTdCRyxLQUFLbUIsYUFBYW5CLEtBQUtvQixlQUFlQyxRQUdqQyxZQUFBTixnQkFBUCxXQUNFLE1BQU8sQ0E3R2Msb0JBQ0gsbUJBa0hiLFlBQUFELGVBQVAsU0FBc0JRLEdBQ04zQyxFQUFzQmdCLFNBQVVyQixFQUErQixTQUN2RWhCLE1BQVFnRSxFQUNkdEIsS0FBS0MsSUFBSSw4QkFBK0JxQixJQUdsQyxZQUFBQyx1QkFBUixXQUNFLE9BQU90QyxNQUFNQyxLQUFLUCxFQUFzQmdCLFNBQVVwQixFQUEwQixNQUFNaUQsYUFHN0UsWUFBQVAsWUFBUCxXQUNFLE9BQU9qQixLQUFLdUIseUJBQ1RFLEtBQUksU0FBQ3JDLEdBQTZCLE9BQUFBLEVBQVFzQyxnQkFHeEMsWUFBQVYsV0FBUCxTQUFrQlcsR0FDSTNCLEtBQUt1Qix5QkFDY3BDLE1BQUssU0FBQ0MsR0FBOEIsT0FBQUEsRUFBUXNDLGNBQWdCQyxLQUVoRjlCLFFBQ25CRyxLQUFLQyxJQUFJLHlCQUEwQjBCLElBRzlCLFlBQUFULHNCQUFQLFdBQ0UsSUFDTVUsRUFEZWpELEVBQXNCZ0IsU0FBVWxCLEdBQ3hCTyxpQkFBaUIsV0FFOUMsT0FBSTRDLEVBQVFDLE9BQ0hELEVBQVEsR0FFUixNQUlILFlBQUFFLG1CQUFSLFNBQTJCQyxHQUN6QixHQUFJQSxFQUFNLENBQ1IsR0FBSUEsRUFBS0wsWUFDUCxPQXhIc0JNLEVBd0hNRCxFQUFLTCxZQXhIR08sRUEzQnhCLG1CQTRCWkMsRUFBa0JGLEVBQUtHLFFBQVEsZ0JBQWlCLEtBRWhEQyxFQURtQkgsRUFBT0ksY0FBY0YsUUFBUSxnQkFBaUIsS0FDOUJHLE1BQU0sS0FDekNDLEVBQWtCTCxFQUFXSSxNQUFNLEtBRW5DRSxFQUFjSixFQUFZSyxRQUFRLE1BQ2xDQyxFQUFjTixFQUFZSyxRQUFRLE1BQ2xDRSxFQUFjUCxFQUFZSyxRQUFRLFFBQ2xDRyxFQUFnQlIsRUFBWUssUUFBUSxNQUNwQ0ksRUFBZ0JULEVBQVlLLFFBQVEsTUFDcENLLEVBQWdCVixFQUFZSyxRQUFRLE1BRXBDTSxFQUFRLElBQUlDLEtBRVpDLEVBQU9OLEdBQWEsR0FBS0osRUFBVUksR0FBYUksRUFBTUcsY0FDdERDLEVBQVFYLEdBQWMsR0FBS0QsRUFBVUMsR0FBY08sRUFBTUssV0FDekRDLEVBQU1YLEdBQVksR0FBS0gsRUFBVUcsR0FBWUssRUFBTU8sVUFFbkRDLEVBQU9YLEdBQWEsR0FBS0wsRUFBVUssR0FBYUcsRUFBTVMsV0FDdERDLEVBQVNaLEdBQWdCLEdBQUtOLEVBQVVNLEdBQWdCRSxFQUFNVyxhQUM5REMsRUFBU2IsR0FBZ0IsR0FBS1AsRUFBVU8sR0FBZ0JDLEVBQU1hLGFBRTdELElBQUlaLEtBQUtDLEVBQU1FLEVBQU9FLEVBQUtFLEVBQU1FLEVBQVFFLEdBbUcxQzNELEtBQUtDLElBQUksd0JBQXlCOEIsUUFHcEMvQixLQUFLQyxJQUFJLHVCQUF3QjhCLEdBN0hWLElBQUNDLEVBQWNDLEVBQ3BDQyxFQUVBRSxFQUNBRyxFQUVBQyxFQUNBRSxFQUNBQyxFQUNBQyxFQUNBQyxFQUNBQyxFQUVBQyxFQUVBRSxFQUNBRSxFQUNBRSxFQUVBRSxFQUNBRSxFQUNBRSxFQTJHSixPQUFPLE1BR0QsWUFBQXZDLGFBQVIsc0JBQ0UsT0FBT25DLE1BQU1DLEtBQUtQLEVBQXNCZ0IsU0FBVWpCLEdBQXlCTSxpQkFBaUIsVUFDekZ5QyxLQUFJLFNBQUNvQyxHQUNKLElBQU1DLEVBQVFELEVBQWE3RSxpQkFBaUIsTUFDdEMrRSxFQUFVRCxFQXhKSyxHQXlKZkUsRUFBV0YsRUF4SlMsR0E2SjFCLE1BQU8sQ0FDTEcsSUFKVUYsRUFBVUEsRUFBUUcsY0FBYyxLQUFLQyxLQUFPLEtBS3REQyxTQUplSixFQUFXLEVBQUtsQyxtQkFBbUJrQyxFQUFTSyxZQUFjLElBQUlyQixTQU9oRnNCLE1BQUssU0FBQ0MsRUFBY0MsR0FBeUIsT0FBQUQsRUFBRUgsU0FBU0ssVUFBWUQsRUFBRUosU0FBU0ssY0FHNUUsWUFBQXRELGFBQVIsU0FBcUJ1RCxHQUNuQjFFLEtBQUtDLElBQUksbUJBQW9CeUUsR0FDekJBLEVBQUtULEtBQ1AxRSxPQUFPb0YsS0FBS0QsRUFBS1QsSUFBSyxXQUc1QixFQWpJQSxHQW1JQzFFLE9BQWVxRixPQUFTLElBQUlDIiwiZmlsZSI6InBhcnNlci5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAwKTtcbiIsImNvbnN0IFJFUE9SVF9JTl9NR0ZPTVMgPSAn0J7RgtGH0ZHRgiDQnNCeINCyINCc0JPQpNCe0JzQoSdcbmNvbnN0IFJFUE9SVF9JTl9TTU8gPSAn0J7RgtGH0ZHRgiDQnNCeINCyINCh0JzQnidcblxuY29uc3QgU1RBUlRfQlVUVE9OX0lEID0gJ3BhcnNlci1zdGFydC1idXR0b24nXG5cbmNvbnN0IERBVEVfRk9STUFUID0gJ2RkLm1tLnl5eXkgaGg6aWknXG5cbmNvbnN0IFNUQVJUX0JVVFRPTl9DT05UQUlORVJfSURfUEFUVEVSTiA9IC9eZmlsdGVyLXBhbmVsLVxcZHs0LH1faGVhZGVyLXRpdGxlLXRleHRFbCQvXG5jb25zdCBNRVNTQUdFX1RZUEVfRklFTERfSURfUEFUVEVSTiA9IC9ebWVzc2FnZVR5cGVDb21iby1cXGR7NCx9LWlucHV0RWwkL1xuY29uc3QgSU5TVVJFUl9GSUVMRF9JRF9QQVRURVJOID0gL15jb21tb25JbnN1cmVyc0NvbWJvLVxcZHs0LH0taW5wdXRFbCQvXG5jb25zdCBJTlNVUkVSU19MSVNUX0lEX1BBVFRFUk4gPSAvXmNvbW1vbkluc3VyZXJzQ29tYm8tXFxkezQsfS1waWNrZXItbGlzdEVsJC9cbmNvbnN0IElOU1VSRVJTX0xJU1RfVE9HR0xFX0lEX1BBVFRFUk4gPSAvXmNvbW1vbkluc3VyZXJzQ29tYm8tXFxkezQsfS10cmlnZ2VyLXBpY2tlciQvXG5jb25zdCBGSUxURVJTX1BBTkVMX0lEX1BBVFRFUk4gPSAvXmZpbHRlci1wYW5lbC1cXGR7NCx9JC9cbmNvbnN0IFBBUkNFTFNfTElTVF9JRF9QQVRURVJOID0gL15wYXJjZWxzTGlzdC1cXGR7NCx9LWJvZHkkL1xuXG5jb25zdCBGSUxFX0xJTktfQ0VMTF9JTkRFWCA9IDVcbmNvbnN0IEZJTEVfU0VORF9EQVRFX0NFTExfSU5ERVggPSA5XG5cbmNvbnN0IEZJTFRFUlNfQ0hBTkdFX0lOVEVSVkFMID0gMjAwMFxuXG5pbnRlcmZhY2UgSUZpbGVEYXRhIHtcbiAgc2VuZERhdGU6IERhdGUsXG4gIHVybDogc3RyaW5nXG59XG5cbmNvbnN0IGdldEVsZW1lbnRCeUlkUGF0dGVybiA9IChwYXJlbnQ6IEhUTUxFbGVtZW50IHwgRG9jdW1lbnQsIGlkUGF0dGVybjogUmVnRXhwLCB0YWdOYW1lOiBzdHJpbmcgPSAnZGl2Jyk6IEVsZW1lbnQgPT4ge1xuICBjb25zdCBlbGVtZW50cyA9IHBhcmVudC5xdWVyeVNlbGVjdG9yQWxsKHRhZ05hbWUpXG4gIHJldHVybiBBcnJheS5mcm9tKGVsZW1lbnRzKS5maW5kKChlbGVtZW50OiBFbGVtZW50KTogYm9vbGVhbiA9PiBpZFBhdHRlcm4udGVzdChlbGVtZW50LmlkKSlcbn1cblxuKHdpbmRvdyBhcyBhbnkpLmdldEVsZW1lbnRCeUlkUGF0dGVybiA9IGdldEVsZW1lbnRCeUlkUGF0dGVyblxuXG5jb25zdCBzdHJpbmdUb0RhdGVCeUZvcm1hdCA9ICh0ZXh0OiBzdHJpbmcsIGZvcm1hdDogc3RyaW5nKTogRGF0ZSA9PiB7XG4gIGNvbnN0IG5vcm1hbGl6ZWQgICAgICA9IHRleHQucmVwbGFjZSgvW15hLXpBLVowLTldL2csICctJylcbiAgY29uc3Qgbm9ybWFsaXplZEZvcm1hdCA9IGZvcm1hdC50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL1teYS16QS1aMC05XS9nLCAnLScpXG4gIGNvbnN0IGZvcm1hdEl0ZW1zICAgICA9IG5vcm1hbGl6ZWRGb3JtYXQuc3BsaXQoJy0nKVxuICBjb25zdCBkYXRlSXRlbXMgICAgICAgPSBub3JtYWxpemVkLnNwbGl0KCctJylcblxuICBjb25zdCBtb250aEluZGV4ICA9IGZvcm1hdEl0ZW1zLmluZGV4T2YoJ21tJylcbiAgY29uc3QgZGF5SW5kZXggICAgPSBmb3JtYXRJdGVtcy5pbmRleE9mKCdkZCcpXG4gIGNvbnN0IHllYXJJbmRleCAgID0gZm9ybWF0SXRlbXMuaW5kZXhPZigneXl5eScpXG4gIGNvbnN0IGhvdXJJbmRleCAgICAgPSBmb3JtYXRJdGVtcy5pbmRleE9mKCdoaCcpXG4gIGNvbnN0IG1pbnV0ZXNJbmRleCAgPSBmb3JtYXRJdGVtcy5pbmRleE9mKCdpaScpXG4gIGNvbnN0IHNlY29uZHNJbmRleCAgPSBmb3JtYXRJdGVtcy5pbmRleE9mKCdzcycpXG5cbiAgY29uc3QgdG9kYXkgPSBuZXcgRGF0ZSgpXG5cbiAgY29uc3QgeWVhciA9IHllYXJJbmRleCA+IC0xID8gK2RhdGVJdGVtc1t5ZWFySW5kZXhdIDogdG9kYXkuZ2V0RnVsbFllYXIoKVxuICBjb25zdCBtb250aCA9IG1vbnRoSW5kZXggPiAtMSA/ICtkYXRlSXRlbXNbbW9udGhJbmRleF0gOiB0b2RheS5nZXRNb250aCgpXG4gIGNvbnN0IGRheSA9IGRheUluZGV4ID4gLTEgPyArZGF0ZUl0ZW1zW2RheUluZGV4XSA6IHRvZGF5LmdldERhdGUoKVxuXG4gIGNvbnN0IGhvdXIgPSBob3VySW5kZXggPiAtMSA/ICtkYXRlSXRlbXNbaG91ckluZGV4XSA6IHRvZGF5LmdldEhvdXJzKClcbiAgY29uc3QgbWludXRlID0gbWludXRlc0luZGV4ID4gLTEgPyArZGF0ZUl0ZW1zW21pbnV0ZXNJbmRleF0gOiB0b2RheS5nZXRNaW51dGVzKClcbiAgY29uc3Qgc2Vjb25kID0gc2Vjb25kc0luZGV4ID4gLTEgPyArZGF0ZUl0ZW1zW3NlY29uZHNJbmRleF0gOiB0b2RheS5nZXRTZWNvbmRzKClcblxuICByZXR1cm4gbmV3IERhdGUoeWVhciwgbW9udGgsIGRheSwgaG91ciwgbWludXRlLCBzZWNvbmQpXG59XG5cbmNsYXNzIFBhcnNlciB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIGNvbnN0IGludGVydmFsSWQgPSBzZXRJbnRlcnZhbCgoKTogdm9pZCA9PiB7XG4gICAgICBjb25zdCBidXR0b25Db250YWluZXIgPSBnZXRFbGVtZW50QnlJZFBhdHRlcm4oZG9jdW1lbnQsIFNUQVJUX0JVVFRPTl9DT05UQUlORVJfSURfUEFUVEVSTilcblxuICAgICAgaWYgKGJ1dHRvbkNvbnRhaW5lcikge1xuICAgICAgICB0aGlzLmFkZFN0YXJ0QnV0dG9uKGJ1dHRvbkNvbnRhaW5lcilcblxuICAgICAgICBjb25zdCBpbnN1cmVyc0xpc3RUb2dnbGUgPSBnZXRFbGVtZW50QnlJZFBhdHRlcm4oZG9jdW1lbnQsIElOU1VSRVJTX0xJU1RfVE9HR0xFX0lEX1BBVFRFUk4pIGFzIEhUTUxFbGVtZW50XG4gICAgICAgIGluc3VyZXJzTGlzdFRvZ2dsZS5jbGljaygpXG4gICAgICAgIHNldFRpbWVvdXQoKCk6IHZvaWQgPT4geyBpbnN1cmVyc0xpc3RUb2dnbGUuY2xpY2soKSB9LCA1MDApXG5cbiAgICAgICAgY2xlYXJJbnRlcnZhbChpbnRlcnZhbElkKVxuICAgICAgfVxuICAgIH0sIDUwMClcblxuXG4gICAgdGhpcy5sb2coJ1BhcnNlciBpbml0aWFsaXplZCEnKVxuICB9XG5cbiAgcHJpdmF0ZSBsb2coLi4uYXJnczogYW55KTogdm9pZCB7XG4gICAgaWYgKGNvbnNvbGUgJiYgY29uc29sZS5sb2cpIHtcbiAgICAgIGNvbnNvbGUubG9nKCdQYXJzZXI6ICcsIC4uLmFyZ3MpXG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhZGRTdGFydEJ1dHRvbihjb250YWluZXI6IEVsZW1lbnQpOiB2b2lkIHtcbiAgICBjb25zdCBidXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKVxuXG4gICAgYnV0dG9uLmlubmVySFRNTCA9ICfQl9Cw0L/Rg9GB0YLQuNGC0Ywg0YHQsdC+0YAg0LTQsNC90L3Ri9GFJ1xuICAgIGJ1dHRvbi5pZCA9IFNUQVJUX0JVVFRPTl9JRFxuICAgIGJ1dHRvbi5zdHlsZS5tYXJnaW5MZWZ0ID0gJzEwcHgnXG4gICAgYnV0dG9uLnN0eWxlLmN1cnNvciA9ICdwb2ludGVyJ1xuICAgIGJ1dHRvbi5vbmNsaWNrID0gKCk6IHZvaWQgPT4geyB0aGlzLnN0YXJ0UGFyc2VyKCkgfVxuXG4gICAgY29udGFpbmVyLmFwcGVuZChidXR0b24pXG5cbiAgICB0aGlzLmxvZygnQWRkZWQgc3RhcnQgYnV0dG9uIHRvIGNvbnRhaW5lcjonLCBjb250YWluZXIpXG4gIH1cblxuICBwdWJsaWMgc3RhcnRQYXJzZXIoKTogdm9pZCB7XG4gICAgdGhpcy5sb2coJ1BhcnNlciBzdGFydGVkIScpXG5cbiAgICB0aGlzLnNldE1lc3NhZ2VUeXBlKHRoaXMuZ2V0TWVzc2FnZVR5cGVzKClbMF0pXG4gICAgdGhpcy5zZXRJbnN1cmVyKHRoaXMuZ2V0SW5zdXJlcnMoKVswXSlcbiAgICB0aGlzLmdldEZpbHRlclN1Ym1pdEJ1dHRvbigpLmNsaWNrKClcblxuICAgIHRoaXMuZG93bmxvYWRGaWxlKHRoaXMuZ2V0RmlsZXNMaXN0KCkucG9wKCkpXG4gIH1cblxuICBwdWJsaWMgZ2V0TWVzc2FnZVR5cGVzKCk6IHN0cmluZ1tdIHtcbiAgICByZXR1cm4gW1xuICAgICAgUkVQT1JUX0lOX01HRk9NUyxcbiAgICAgIFJFUE9SVF9JTl9TTU9cbiAgICBdXG4gIH1cblxuICBwdWJsaWMgc2V0TWVzc2FnZVR5cGUobWVzc2FnZVR5cGU6IHN0cmluZyk6IHZvaWQge1xuICAgIGNvbnN0IGlucHV0ID0gZ2V0RWxlbWVudEJ5SWRQYXR0ZXJuKGRvY3VtZW50LCBNRVNTQUdFX1RZUEVfRklFTERfSURfUEFUVEVSTiwgJ2lucHV0JykgYXMgSFRNTElucHV0RWxlbWVudFxuICAgIGlucHV0LnZhbHVlID0gbWVzc2FnZVR5cGVcbiAgICB0aGlzLmxvZygnU2V0IG1lc3NhZ2UgdHlwZSBmaWx0ZXIgdG86JywgbWVzc2FnZVR5cGUpXG4gIH1cblxuICBwcml2YXRlIGdldEluc3VyZXJzU3VnZ2VzdGlvbnMoKTogQ2hpbGROb2RlW10ge1xuICAgIHJldHVybiBBcnJheS5mcm9tKGdldEVsZW1lbnRCeUlkUGF0dGVybihkb2N1bWVudCwgSU5TVVJFUlNfTElTVF9JRF9QQVRURVJOLCAndWwnKS5jaGlsZE5vZGVzKVxuICB9XG5cbiAgcHVibGljIGdldEluc3VyZXJzKCk6IHN0cmluZ1tdIHtcbiAgICByZXR1cm4gdGhpcy5nZXRJbnN1cmVyc1N1Z2dlc3Rpb25zKClcbiAgICAgIC5tYXAoKGVsZW1lbnQ6IEVsZW1lbnQpOiBzdHJpbmcgPT4gZWxlbWVudC50ZXh0Q29udGVudClcbiAgfVxuXG4gIHB1YmxpYyBzZXRJbnN1cmVyKGluc3VyZXI6IHN0cmluZyk6IHZvaWQge1xuICAgIGNvbnN0IHN1Z2dlc3Rpb25zID0gdGhpcy5nZXRJbnN1cmVyc1N1Z2dlc3Rpb25zKClcbiAgICBjb25zdCBtYXRjaGluZ1N1Z2dlc3Rpb24gPSBzdWdnZXN0aW9ucy5maW5kKChlbGVtZW50OiBFbGVtZW50KTogYm9vbGVhbiA9PiBlbGVtZW50LnRleHRDb250ZW50ID09PSBpbnN1cmVyKSBhcyBIVE1MRWxlbWVudFxuXG4gICAgbWF0Y2hpbmdTdWdnZXN0aW9uLmNsaWNrKClcbiAgICB0aGlzLmxvZygnU2V0IGluc3VyZXIgZmlsdGVyIHRvOicsIGluc3VyZXIpXG4gIH1cblxuICBwdWJsaWMgZ2V0RmlsdGVyU3VibWl0QnV0dG9uKCk6IEhUTUxFbGVtZW50IHwgbnVsbCB7XG4gICAgY29uc3QgZmlsdGVyc1BhbmVsID0gZ2V0RWxlbWVudEJ5SWRQYXR0ZXJuKGRvY3VtZW50LCBGSUxURVJTX1BBTkVMX0lEX1BBVFRFUk4pIGFzIEhUTUxFbGVtZW50XG4gICAgY29uc3QgYnV0dG9ucyA9IGZpbHRlcnNQYW5lbC5xdWVyeVNlbGVjdG9yQWxsKCdhLngtYnRuJylcblxuICAgIGlmIChidXR0b25zLmxlbmd0aCkge1xuICAgICAgcmV0dXJuIGJ1dHRvbnNbMF0gYXMgSFRNTEVsZW1lbnRcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIG51bGxcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGdldERhdGVGcm9tRWxlbWVudChub2RlOiBOb2RlKTogRGF0ZSB7XG4gICAgaWYgKG5vZGUpIHtcbiAgICAgIGlmIChub2RlLnRleHRDb250ZW50KSB7XG4gICAgICAgIHJldHVybiBzdHJpbmdUb0RhdGVCeUZvcm1hdChub2RlLnRleHRDb250ZW50LCBEQVRFX0ZPUk1BVClcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMubG9nKCdFbXB0eSBEYXRlIENlbGwgVGV4dCEnLCBub2RlKVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmxvZygnRGF0ZSBub2RlIG5vdCBmb3VuZCEnLCBub2RlKVxuICAgIH1cblxuICAgIHJldHVybiBudWxsXG4gIH1cblxuICBwcml2YXRlIGdldEZpbGVzTGlzdCgpOiBhbnlbXSB7XG4gICAgcmV0dXJuIEFycmF5LmZyb20oZ2V0RWxlbWVudEJ5SWRQYXR0ZXJuKGRvY3VtZW50LCBQQVJDRUxTX0xJU1RfSURfUEFUVEVSTikucXVlcnlTZWxlY3RvckFsbCgndGFibGUnKSlcbiAgICAgIC5tYXAoKHRhYmxlRWxlbWVudDogSFRNTEVsZW1lbnQpOiBJRmlsZURhdGEgPT4ge1xuICAgICAgICBjb25zdCBjZWxscyA9IHRhYmxlRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCd0ZCcpXG4gICAgICAgIGNvbnN0IHVybENlbGwgPSBjZWxsc1tGSUxFX0xJTktfQ0VMTF9JTkRFWF1cbiAgICAgICAgY29uc3QgZGF0ZUNlbGwgPSBjZWxsc1tGSUxFX1NFTkRfREFURV9DRUxMX0lOREVYXVxuXG4gICAgICAgIGNvbnN0IHVybCA9IHVybENlbGwgPyB1cmxDZWxsLnF1ZXJ5U2VsZWN0b3IoJ2EnKS5ocmVmIDogbnVsbFxuICAgICAgICBjb25zdCBzZW5kRGF0ZSA9IGRhdGVDZWxsID8gdGhpcy5nZXREYXRlRnJvbUVsZW1lbnQoZGF0ZUNlbGwuZmlyc3RDaGlsZCkgOiBuZXcgRGF0ZSgpXG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB1cmwsXG4gICAgICAgICAgc2VuZERhdGVcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICAgIC5zb3J0KChhOiBJRmlsZURhdGEsIGI6IElGaWxlRGF0YSk6IG51bWJlciA9PiBhLnNlbmREYXRlLmdldFRpbWUoKSAtIGIuc2VuZERhdGUuZ2V0VGltZSgpKVxuICB9XG5cbiAgcHJpdmF0ZSBkb3dubG9hZEZpbGUoZmlsZTogSUZpbGVEYXRhKTogdm9pZCB7XG4gICAgdGhpcy5sb2coJ2ZpbGUgZG93bmxvYWQgPj4nLCBmaWxlKVxuICAgIGlmIChmaWxlLnVybCkge1xuICAgICAgd2luZG93Lm9wZW4oZmlsZS51cmwsICdfYmxhbmsnKVxuICAgIH1cbiAgfVxufVxuXG4od2luZG93IGFzIGFueSkucGFyc2VyID0gbmV3IFBhcnNlcigpXG4iXSwic291cmNlUm9vdCI6IiJ9